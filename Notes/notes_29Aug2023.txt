Day 2:



List of participants who have not receives email from amazon workspace:
Gowrika T.K
Komal G.D
Skanda Smaran V
Rajvir Saini
Ramyashree R
Niharika
Tejas
Chenna Kesava Reddy
---------------------------------
Pending:
	constraints	at column level, table level
	adding constraints to the columns while 
	creating table, 
	alter table, 

	drop constraints

constraints
	restrictions
	conditions that must pass
	limit
	boundary
	rules that must comply
These constraints are used to enfore data integrity.

are applied to columns of a table

PRIMARY KEY
FOREIGN KEY
CANDIDATE KEY
ALTERNATE KEY
SUPER KEY
COMPOSITE KEY
UNIQUE CONSTRAINT
NOT NULL CONSTRAINT
CHECK CONSTRAINT

These constraints are used to enfore data integrity.
what is data integrity?
	correctness of the data
types of integrity:
	Entity integrity
	Domain integrity
	Referential integrity
	User defined data integrity

What is Entity integrity?	(Primary key)		row level
	ensures that we would be able to identify any record (row) in a table uniquely using one or more column(s).	These columns are primary key column(s).

What is Domain integrity?	column level
	Data in a column must follow the domain rule.
	we can implement domain integrity using 
		CHECK constraint
		
What is Referential integrity?
	The data in a table will be verified against the data in another table.
	The foreign key of a table is verified against the primary key of another table.	

1 Steven 	King	1231	(1231 is an invalid department id. So it is not allowed here)
	
	
Foreign key
	allows NULL
	allows Duplicate
	can be created that references a column which is UNIQUE and NOT NULL
	can be composite, when the primary key it references is composite.

	supports the following response to DELETE and UPDATE of primary key table records
		CASCADE
		RESTRICT		(by default)
		SET NULL		(NULLIFY)	

Primary key is in MASTER table
Foreign key is in DETAILS table 		(also called as TRANSACTION table)

USER_MASTER		(has no foreign keys)
SALES_DETAILS		(has foreign keys)

What is User Defined Data integrity?
	Any rules enforced other than the above integrity, are user defined.
	we can implement them using Triggers, User defined types

Practical:

1) PRIMARY KEY
	does not allow NULL
	does not allow DUPLICATES
	can be COMPOSITE
	can be defined even after the table is created already.

CREATE TABLE TICKETS
(
  id int,
	seatno VARCHAR2(100),
    theatreName VARCHAR2(100)
);
	
INSERT INTO TICKETS VALUES(1, 'A1','PVR Soul Spirit Mall');
INSERT INTO TICKETS VALUES(1, 'A1','PVR Soul Spirit Mall');

ALTER TABLE TICKETS ADD CONSTRAINT PKTICKETS1 PRIMARY KEY (ID);
--Error
ORA-02437: cannot validate (SQL_NUEVXSBXIDXBAASYYMEIWVBCG.PKTICKETS1) - primary key violated 


DELETE FROM TICKETS;

2 row(s) deleted.

INSERT INTO TICKETS VALUES(1, 'A1','PVR Soul Spirit Mall');
1 row(s) inserted.

INSERT INTO TICKETS VALUES(2, 'E11','INOX Nexus Forum Mall');
1 row(s) inserted.


select * from tickets;

Result Set 2
ID	SEATNO	THEATRENAME
1	A1	PVR Soul Spirit Mall
2	E11	INOX Nexus Forum Mall
Download CSV
2 rows selected.



ALTER TABLE TICKETS ADD CONSTRAINT PKTICKETS1 PRIMARY KEY (ID);
Table altered.

Activity:
1) Create a table and define primary key for a column at column level
CREATE TABLE MOVIE
(
    ID INT PRIMARY KEY,
    NAME VARCHAR2(20)
);
2) Create a table and define primary key for a column at table level
CREATE TABLE MOVIE
(
    ID INT,
    NAME VARCHAR2(20),
    PRIMARY KEY(ID)
);
3) Create a table without primary key and ALTER the table and add constraint with constraint name

CREATE TABLE MOVIE
(
    ID INT,
    NAME VARCHAR2(20)
);
ALTER TABLE MOVIE ADD PRIMARY KEY(ID);
ALTER TABLE MOVIE ADD CONSTRAINT PK1 PRIMARY KEY(ID);

4) Remove that constraint 	(problem: we dont know the constraint name.  Find the constraint name from dictionary. 	SELECT * FROM USER_CONSTRAINTS;
ALTER TABLE MOVIE DROP CONSTRAINT SYS_C00129973268;

------------------------------------
FOREIGN KEY
	
example:
	Ticket table should contain a column "movie_id" that references "id" of "movie" table

If you already have movie, ticket tables, drop them.

Create both tables and implement primary and foreign keys accordingly.



TABLE MOVIEResult Set 7
Column	Null?	Type
ID	 - 	NUMBER
NAME	 - 	VARCHAR2(20)



-- alter table movie add constraint pkm1 primary key(id);
create table ticket
(
    id int primary key,
    seat_no char(5),
    movie_id int references movie(id)
);


insert into movie values(1, 'Jailer');
insert into movie values(2, 'Kantara');

insert into ticket values(1,'A12',11);
ORA-02291: integrity constraint (SQL_NUEVXSBXIDXBAASYYMEIWVBCG.SYS_C00129975953) violated - parent key not found ORA-06512: at "SYS.DBMS_SQL", line 1721

ERROR is because, 11 is invalid movie id.

insert into ticket values(1,'A12',2);
1 row(s) inserted.




create table ticket
(
    id int primary key,
    seat_no char(5),
    movie_id int constraint fkm1 foreign key references movie(id)
);


-- drop table ticket;
create table ticket
(
    id int primary key,
    seat_no char(5),
    movie_id int,
    constraint fkm1 foreign key(movie_id) references movie(id)
);


-------------------
Activity:
	NOT NULL
	UNIQUE
	CHECK


CREATE TABLE SHOWS
(
    ID int UNIQUE NOT NULL
    
);



DROP TABLE SHOWS;



CREATE TABLE SHOWS
(
    ID int UNIQUE NOT NULL,
    CAPACITY int,
    CHECK(CAPACITY>0)
    
);

INSERT INTO SHOWS VALUES(1,-1);
ORA-02290: check constraint (SQL_NUEVXSBXIDXBAASYYMEIWVBCG.SYS_C00129976849) violated ORA-06512: at "SYS.DBMS_SQL", line 1721


INSERT INTO SHOWS VALUES(1,1);
1 row(s) inserted.

-------------------------------------------
DML	-	Data Manipulation Language

INSERT
UPDATE
DELETE

Activity:
	Insert a row into the table with values in the correct order
	Insert a row into the table with values in different order, but mentioned in the statement.
	Insert a row into the table with DEFAULT values
	Insert multiple rows to a table using single INSERT statement
	Insert into a table using SELECT statement that retrieves all rows from another table
	Insert into a table using SELECT statement that retrieves specific rows from another table

	


-- create table jdepartments
-- as
-- select * from hr.departments;

select * from jdepartments;
-- delete from jdepartments where department_id>30;
select * from jdepartments;

1) Insert a row into the table with values in the correct order:-
INSERT INTO JDEPARTMENTS VALUES(40,'IT',100,1700);

2) Insert a row into the table with values in different order, but mentioned in the statement.:-
INSERT INTO JDEPARTMENTS (DEPARTMENT_NAME, DEPARTMENT_ID, MANAGER_ID, LOCATION_ID) 
VALUES ('ECE',50,101,1800);

INSERT INTO JDEPARTMENTS (DEPARTMENT_NAME, DEPARTMENT_ID, LOCATION_ID) 
VALUES ('EEE',60,1800);


3) Insert a row into the table with DEFAULT values
ALTER TABLE JDEPARTMENTS ADD STRENGTH INT DEFAULT 10;
INSERT INTO JDEPARTMENTS VALUES(70,'CSE',100,1700,DEFAULT);

INSERT INTO JDEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID)VALUES(80,'Electicity',100,1700);	--DEFAULT value applied for STRENGTH column

4) Insert multiple rows to a table using single INSERT statement:-
-- select * from jdepartments;
INSERT ALL
	INTO JDEPARTMENTS VALUES (90,'Police',101,1700,DEFAULT)
	INTO JDEPARTMENTS VALUES (100,'Income Tax',102,1700,100)
SELECT * FROM DUAL;







SELECT 10*10 FROM DUAL;
SELECT SYSDATE FROM DUAL;

5) Insert into a table using SELECT statement that retrieves all rows from another table:-


CREATE TABLE JEMPLOYEES AS
SELECT * FROM HR.EMPLOYEES;

DELETE FROM JEMPLOYEES;

INSERT INTO JEMPLOYEES
SELECT * FROM HR.EMPLOYEES;

6) Insert into a table using SELECT statement that retrieves specific rows from another table

DELETE FROM JEMPLOYEES;

INSERT INTO JEMPLOYEES
SELECT * FROM HR.EMPLOYEES WHERE SALARY>10000;
15 row(s) inserted.

----------------------------------------------

DML statements run in transactions.
Transaction can be implicit transaction or explicit transaction.

What are implicit transactions?
	they start and end themselves.

What are explicit transactions?
	they are demacated by users.	
	the begining of transaction and the end of transaction are defined explicitly
	end of the transaction can be done by commit or rollback.
	BEGIN TRANSACTION
Every DML statement itself is a transaction



TRUNCATE
	is fast when compared to DELETE statement. Because, it is like DROP and CREATE
	DELETE works on rows one by one. It takes time. Also, in case, there are DELETE triggers, then for each row, it may fire.	TRUNCATE does not trigger DELETE Triggers.
	is DDL. It cannot be rolledback.
	only DML statements can be rolledback.
	
UPDATE
	In the table, where already you have added records, try to update one (or) all (or) specific rows. You will specify the column name and value in the UPDATE statement. WHERE condition is optional. If you do not provide WHERE condition, then all rows are updated.


DELETE



SQL> ALTER TABLE EMP ADD NATIONALITY VARCHAR2(50);

Table altered.

Activity:
	UPDATE	(All rows, specific row(s))
	DELETE	(specific row(s), all rows)

Understand the difference between DELETE and TRUNCATE
------------------------------------------------------------------------------
TCL
	Transaction Control Language
		COMMIT
		SAVEPOINT
		ROLLBACK

DCL
	Data Control Language
		GRANT
		REVOKE

PRIVILEGES
		OBJECT PRIVILEGES
			SELECT ON EMPLOYEES
			INSERT
			UPDATE
			DELETE
		SYSTEM PRIVILEGES		
			CREATE SESSION
			CREATE TABLE
			CREATE USER
			



CREATE USER JAG IDENTIFIED BY JAG;


SYSTEM PRIVILEGES are not cascade.
	means?
		GRANT CREATE TABLE TO GOWRIKA WITH ADMIN OPTION
		if SYS grants CREATE TABLE with admin option to gowrika, 	
		then gowrika grants this privilege to shushwant
		After that SYS revokes this privilege from gowrika,
		but shushwant continues to use this privilege.


OBJECT PRIVILEGES	 are cascade
		GRANT SELECT ON EMPLOYEES TO GOWRIKA WITH GRANT OPTION;
		now, gowrika can grant this privilege to shushwant.
		when sys revokes the privilege from gowrika,
		shushwant also lose this privilege.

-------------------------
Activity:
	understand the privileges in oracle.
	types of privileges
	WITH ADMIN OPTION
	WITH GRANT OPTION
